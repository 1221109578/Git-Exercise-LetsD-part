<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LetsD'part</title>
    <link rel="stylesheet" href="static/css/Home.css">
    <link rel="stylesheet" href="static/css/countries.css">
    <link rel="icon" href="\static\Logo.png" type="image/icon type">
</head>
<body>
    <header>
        <nav>
            <div class="logo-container">
                <div class="logo">
                    <img src="/static/Logo.png" alt="Logo">
                </div>
            </div>
            <div class="nav-links">
                <ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/package">Travel Packages</a></li>
                    {% if user.is_authenticated %}
                    <li><a href="/myaccount">My Account</a></li>
                    <li><a href="/Booking">Booking</a></li>
                    <li><a href="/chat">Chat</a></li> 
                    {% endif %}
                    {% if user.is_admin %}
                    <li><a href="/admin">Admin</a></li>   
                    {% endif %} 
                </ul>
            </div>
            <div class="auth-buttons">
                {% if user.is_authenticated %}
                <a href="/logout">Log Out</a>
                {% else %}
                <a href="/login">Log In</a>
                {% endif %}
            </div>
        </nav>
    </header>

    <div>
        <div class="greet">
        <h1>Browse Your Holidays</h1>
        </div>
        <button id="filter-button" type="submit" class="filter-show">Filter</button>
        <section id="filter-section" class="filter-section">
            <div class="filter-box">
                <form action="/package" method="get" class="filter-form">
                        <div class="filter-group">
                            <label for="country">Country:</label>
                            <select name="country" id="country">
                                <option value="">All</option>
                                {% for country in countries %}
                                <option value="{{ country[0] }}">{{ country[0] }}</option>
                                {% endfor %}
                            </select>
                        </div>
        
                        <div class="filter-group">
                            <label for="city">City:</label>
                            <select name="city" id="city">
                                <option value="">All</option>
                                {% for city in cities %}
                                <option value="{{ city[0] }}">{{ city[0] }}</option>
                                {% endfor %}
                            </select>
                        </div>
        
                        <div class="filter-group">
                            <label for="price_min">Minimum Price:</label>
                            <input type="number" name="price_min" id="price_min">
                        </div>
        
                        <div class="filter-group">
                            <label for="price_max">Maximum Price:</label>
                            <input type="number" name="price_max" id="price_max">
                        </div>
                    </div>
        
                    <div class="filter-row">
                        <div class="filter-group">
                            <label for="hotel">Hotel:</label>
                            <select name="hotel" id="hotel">
                                <option value="">All</option>
                                {% for hotel in hotels %}
                                <option value="{{ hotel[0] }}">{{ hotel[0] }}</option>
                                {% endfor %}
                            </select>
                        </div>
        
                        <div class="filter-group">
                            <label for="airline">Airline:</label>
                            <select name="airline" id="airline">
                                <option value="">All</option>
                                {% for airline in airlines %}
                                <option value="{{ airline[0] }}">{{ airline[0] }}</option>
                                {% endfor %}
                            </select>
                        </div>
        
                        <div class="filter-group">
                            <label for="pax">Pax:</label>
                            <select name="pax" id="pax">
                                <option value="">All</option>
                                {% for pax in paxes %}
                                <option value="{{ pax[0] }}">{{ pax[0] }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div class="filter-group">
                            <label for="date_start">Start Date:</label>
                            <input type="date" name="date_start" id="date_start">
                        </div>
                        <div class="filter-group">
                            <label for="date_end">End Date:</label>
                            <input type="date" name="date_end" id="date_end">
                        </div>
                    </div>    
                    <button type="submit" class="filter-button">Apply <br> Filter</button>
                </form>
            </div>
        </section>
    </div>
    <script src="{{ url_for('static', filename='js/filter.js') }}"></script>
    
{% if message %}
    <p class="empty-msg">{{ message }}</p>
{% else %}
    {% for package in travel_packages %}
    {% if package.availability > 0 %}
    <section class="package-details">
        <div class="package-box">
            <div class="package-image">
                <img src="{{ package.image_url }}" alt="Package Image">
            </div>
            <div class="package-info">
                <h1>Travel Package: {{ package.city }}, {{ package.country }}</h1>
                <p class="destination-description">{{ package.description }}</p>
                <div class="details">
                    <p><strong>Price:</strong> RM{{ package.price }}</p>
                    <p><strong>Duration:</strong> {{ package.days }} Days, {{ package.nights }} Nights</p>
                    <p><strong>Date:</strong> {{ package.date }} <strong>To</strong> {{ package.date_end }}</p>
                    <p><strong>Airline:</strong> {{ package.airline_name }}</p>
                    <p><strong>Hotel:</strong> {{ package.hotel_name }}</p>
                    <p><strong>Pax:</strong> {{ package.pax }}</p>
                </div>
                <form action="{{ url_for('client.add_to_cart', package_id=package.id) }}" method="POST">
                    <button type="submit" class="btn btn-primary">Book Now</button>
                    <div class="quantity-input">
                        <label for="quantity">Quantity:</label>
                        <select id="quantity" name="quantity">
                            {% for qty in range(1, package.availability + 1) %}
                                <option value="{{ qty }}">{{ qty }}</option>
                            {% endfor %}
                        </select>
                    </div>
                </form>
                
                <p><strong>Availability:</strong> {{ package.availability }}</p>
                <p class="book-now-description">Limited availability. Book your package now to secure your spot!</p>
            </div>
        </div>
    </section>
    {% endif %}
    {% endfor %}
{% endif %}

<footer>Â© 2024 LetsD'Part. All rights reserved.</footer>
</body>
</html>